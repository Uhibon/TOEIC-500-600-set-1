<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>TOEIC (500-600) set-1 â€“ Boo-riculum</title>
  <link rel="icon" type="image/png" href="booha-ghost.png">
  <style>
    :root { --ink:#222; --muted:#444; --accent:#0b78ff; --ok:#22c55e; --bad:#ef4444; }
    html,body{height:100%; margin:0;}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;
      color:var(--ink);
      background:url('Booha card.jpg') center/cover fixed no-repeat;
      overflow:hidden;
    }
    .wrap{height:100%;max-width:900px;margin:0 auto;padding:max(10px,env(safe-area-inset-top)) max(16px,env(safe-area-inset-right)) max(10px,env(safe-area-inset-bottom)) max(16px,env(safe-area-inset-left));display:flex;flex-direction:column;gap:10px;box-sizing:border-box}
    header{display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between;background:rgba(255,255,255,.88);padding:12px 16px;border-radius:16px;box-shadow:0 4px 10px rgba(0,0,0,.15)}
    header h1{font-size:18px;margin:0;font-weight:800;letter-spacing:.3px;background:linear-gradient(90deg,#7dd3fc,#60a5fa,#a78bfa,#f472b6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;display:flex;align-items:center;gap:8px}
    header h1 img{height:28px;width:auto}
    .controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
    select,button{background:rgba(255,255,255,.95);color:var(--ink);border:1px solid #ccc;border-radius:12px;padding:10px 12px;font-size:14px;box-shadow:0 2px 5px rgba(0,0,0,.08)}
    button{cursor:pointer;transition:transform .05s ease,background .2s}
    button:hover{background:#f0f0f0}
    button:active{transform:scale(.98)}
    .pill{border:1px solid #ccc;border-radius:999px;padding:6px 10px;font-size:12px;background:rgba(255,255,255,.7)}
    .card{flex:1 1 auto;min-height:0;user-select:none;-webkit-user-select:none;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;background:url('Booha card.jpg') center/cover no-repeat;border:1px solid #ccc;border-radius:24px;padding:16px 16px 20px;margin:0;box-shadow:0 10px 40px rgba(0,0,0,.25);position:relative;overflow:hidden}
    .brand{position:absolute;top:10px;left:12px;display:flex;gap:8px;align-items:center;background:rgba(255,255,255,.85);padding:6px 10px;border-radius:12px;border:1px solid #ddd;box-shadow:0 2px 6px rgba(0,0,0,.08);font-weight:800;letter-spacing:.2px}
    .brand img{height:20px;width:auto}
    .brand span{background:linear-gradient(90deg,#7dd3fc,#60a5fa,#a78bfa,#f472b6);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .label{color:var(--muted);font-size:13px;letter-spacing:.3px;margin-bottom:8px;background:rgba(255,255,255,.7);padding:4px 8px;border-radius:8px}
    .picture{display:block;width:min(96%,860px);max-height:52vh;height:auto;object-fit:contain;border-radius:16px;border:1px solid #ddd;box-shadow:0 6px 18px rgba(0,0,0,.15);background:#fff;margin:6px auto 12px}
    .main{font-size:28px;line-height:1.25;font-weight:800;margin:8px 0 10px;background:rgba(255,255,255,.86);padding:8px 12px;border-radius:12px}
    .sub{font-size:18px;opacity:.92;margin:0 0 6px;background:rgba(255,255,255,.65);padding:4px 10px;border-radius:8px}
    .hira{font-size:18px;color:var(--accent);opacity:.95;background:rgba(255,255,255,.75);padding:4px 10px;border-radius:8px}
    .muted{color:var(--muted)}
    .row{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;align-items:center}
    .footer{flex:0 0 auto;display:flex;align-items:center;justify-content:space-between;margin-top:8px;color:var(--muted);font-size:13px;background:rgba(255,255,255,.85);padding:8px 12px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.1)}
    .progress{height:8px;border-radius:999px;background:#eee;overflow:hidden}
    .progress>span{display:block;height:100%;background:linear-gradient(90deg,#7dd3fc,#60a5fa,#a78bfa,#f472b6);width:0%}
    .grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}
    @media (max-width:700px){.grid{grid-template-columns:repeat(2,minmax(0,1fr));}.main{font-size:24px}}
    a{color:#0b78ff;text-decoration:none}
    .hidden{display:none}
    .options{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:12px}
    .optbtn{border:1px solid #ccc;border-radius:12px;padding:10px 14px;background:rgba(255,255,255,.95);cursor:pointer}
    .optbtn.ok{background:#dcfce7;border-color:#86efac;color:#166534}
    .optbtn.bad{background:#fee2e2;border-color:#fca5a5;color:#991b1b}
    .small{font-size:15px;line-height:1.45}
    .qaOnly{display:none}
    .playBtn{background:#ef4444;color:#fff;border-color:#dc2626;font-weight:800}
    .playBtn.paused::after{content:' â–¶ï¸'}
    .playBtn.playing::after{content:' â…¡'}
    .speedBtn{min-width:74px;text-align:center}

    /* Welcome overlay */
    .welcomeOverlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:50;background:linear-gradient(180deg,rgba(255,255,255,.92),rgba(255,255,255,.86))}
    .welcomeOverlay.hidden{display:none !important;visibility:hidden !important;pointer-events:none !important;}
    .welcomeCard{max-width:720px;width:min(92%,720px);text-align:center;background:rgba(255,255,255,.96);border:1px solid #ddd;border-radius:24px;box-shadow:0 12px 40px rgba(0,0,0,.18);padding:28px}
    .welcomeCard img{width:96px;height:auto;margin:8px auto 12px;display:block}
    .welcomeCard h2{margin:6px 0 10px;font-size:24px}
    .welcomeCard p{margin:6px 0 14px;font-size:16px;color:#333}
    .startBtn{background:#0b78ff;color:#fff;border:0;padding:12px 18px;border-radius:12px;font-weight:800;cursor:pointer;box-shadow:0 6px 18px rgba(11,120,255,.25)}
  </style>
</head>
<body>

<!-- Welcome -->
<div id="welcome" class="welcomeOverlay">
  <div class="welcomeCard">
    <img src="booha-ghost.png" alt="Booha ghost">
    <h2>ã‚ˆã†ã“ãï¼šTOEICï¼ˆ500ã€œ600ï¼‰ã‚»ãƒƒãƒˆ1</h2>
    <p>Welcome to TOEIC (500â€“600) set 1</p>
    <button id="startBtn" class="startBtn">Start / ã¯ã˜ã‚ã‚‹</button>
  </div>
</div>

<div class="wrap hidden" id="app" aria-hidden="true">
  <header>
    <h1><img src="booha-ghost.png" alt=""> Boo-riculum â€“ TOEIC (500-600) set-1</h1>
    <div class="controls">
      <select id="mode" aria-label="Mode">
        <option value="vocab-j2e">Vocab: ğŸ‡¯ğŸ‡µ â†’ ğŸ‡ºğŸ‡¸</option>
        <option value="vocab-e2j">Vocab: ğŸ‡ºğŸ‡¸ â†’ ğŸ‡¯ğŸ‡µ</option>
        <option value="sentences">Sentences (practice)</option>
        <option value="qa" selected>Questions (practice)</option>
        <option value="quiz">Quiz (multiple choice)</option>
        <option value="reading">Reading</option>
      </select>
    </div>
  </header>

  <div id="card" class="card" role="button" aria-label="flashcard" tabindex="0">
    <div class="brand">
      <img src="booha-ghost.png" alt="Booha ghost">
      <span>Boo-riculum</span>
    </div>
    <div id="label" class="label">Front</div>

    <img id="pic" class="picture hidden" alt="illustration">
    <div id="main" class="main">â€”</div>
    <div id="sub" class="sub muted">Tap or press Space to flip</div>
    <div id="hira" class="hira hidden"></div>
    <div id="mcArea" class="options hidden"></div>
  </div>

  <div class="footer">
    <div class="row">
      <span class="pill">Keyboard: â† â†’</span>
      <span class="pill">Space = Flip</span>
      <button id="btnPrev">â—€ï¸ Prev</button>
      <button id="btnFlip">Flip</button>
      <button id="btnNext">Next â–¶ï¸</button>
      <button id="btnShuffle">Shuffle</button>
      <!-- QA audio controls -->
      <button id="btnPlay" class="playBtn qaOnly paused" aria-label="Play/Pause audio">Play</button>
      <button id="btnSpeed" class="speedBtn qaOnly" aria-label="Playback speed">1.0Ã—</button>
    </div>
    <div style="min-width:180px;text-align:right">
      <div id="counter" class="muted">0 / 0</div>
      <div class="progress" aria-hidden="true"><span id="bar"></span></div>
    </div>
  </div>

  <audio id="qaAudio" preload="metadata" playsinline></audio>
</div>

<script>
  // ---------- DATA ----------
  const VOCAB = [
    { en:"accomplish", ja:"é”æˆã™ã‚‹" }, { en:"allocate", ja:"å‰²ã‚Šå½“ã¦ã‚‹" },
    { en:"approximately", ja:"ãŠã‚ˆãï¼ç´„" }, { en:"assemble", ja:"çµ„ã¿ç«‹ã¦ã‚‹ï¼›é›†ã‚ã‚‹" },
    { en:"assume", ja:"ä»®å®šã™ã‚‹ï¼›å¼•ãå—ã‘ã‚‹" }, { en:"authorize", ja:"æ‰¿èªã™ã‚‹ï¼›èªå¯ã™ã‚‹" },
    { en:"capacity", ja:"èƒ½åŠ›ï¼›åå®¹èƒ½åŠ›" }, { en:"cautious", ja:"ç”¨å¿ƒæ·±ã„ï¼›æ…é‡ãª" },
    { en:"clarify", ja:"æ˜ç¢ºã«ã™ã‚‹" }, { en:"collaborate", ja:"å”åŠ›ã™ã‚‹ï¼›å…±åŒã§è¡Œã†" },
    { en:"compile", ja:"ã¾ã¨ã‚ã‚‹ï¼›ç·¨é›†ã™ã‚‹" }, { en:"confirm", ja:"ç¢ºèªã™ã‚‹" },
    { en:"conserve", ja:"ç¯€ç´„ã™ã‚‹ï¼›ä¿å­˜ã™ã‚‹" }, { en:"consistent", ja:"ä¸€è²«ã—ãŸï¼›çŸ›ç›¾ã®ãªã„" },
    { en:"decline", ja:"æ–­ã‚‹ï¼›æ¸›å°‘ã™ã‚‹" }, { en:"encourage", ja:"åŠ±ã¾ã™ï¼›ä¿ƒã™" },
    { en:"evaluate", ja:"è©•ä¾¡ã™ã‚‹" }, { en:"implement", ja:"å®Ÿè¡Œã™ã‚‹ï¼›å®Ÿæ–½ã™ã‚‹" },
    { en:"maintain", ja:"ç¶­æŒã™ã‚‹ï¼›ä¸»å¼µã™ã‚‹" }, { en:"suspend", ja:"ä¸€æ™‚åœæ­¢ã™ã‚‹ï¼›ä¿ç•™ã«ã™ã‚‹" }
  ];

  const SENTENCES = [
    { en:"We need to allocate more time to training.", ja:"ç ”ä¿®ã«ã‚‚ã£ã¨æ™‚é–“ã‚’å‰²ã‚Šå½“ã¦ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚" },
    { en:"The parts are easy to assemble with the manual.", ja:"ãã®éƒ¨å“ã¯å–æ‰±èª¬æ˜æ›¸ã§ç°¡å˜ã«çµ„ã¿ç«‹ã¦ã‚‰ã‚Œã¾ã™ã€‚" },
    { en:"Please confirm your attendance by Friday.", ja:"é‡‘æ›œæ—¥ã¾ã§ã«å‡ºæ¬ ã‚’ã”ç¢ºèªãã ã•ã„ã€‚" },
    { en:"Sales declined slightly last quarter.", ja:"å…ˆå››åŠæœŸã«å£²ä¸Šã¯ã‚ãšã‹ã«æ¸›å°‘ã—ã¾ã—ãŸã€‚" },
    { en:"Her explanation clarified the policy.", ja:"å½¼å¥³ã®èª¬æ˜ã§æ–¹é‡ãŒæ˜ç¢ºã«ãªã‚Šã¾ã—ãŸã€‚" },
    { en:"The company authorized the refund.", ja:"ä¼šç¤¾ã¯è¿”é‡‘ã‚’æ‰¿èªã—ã¾ã—ãŸã€‚" },
    { en:"Our factory operates at full capacity in summer.", ja:"å½“å·¥å ´ã¯å¤ã«æœ€å¤§ç¨¼åƒã—ã¦ã„ã¾ã™ã€‚" },
    { en:"Be cautious when signing the contract.", ja:"å¥‘ç´„ã«ç½²åã™ã‚‹éš›ã¯æ…é‡ã«ãªã£ã¦ãã ã•ã„ã€‚" },
    { en:"We will collaborate with a local supplier.", ja:"åœ°å…ƒã®ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã¨å”åŠ›ã—ã¾ã™ã€‚" },
    { en:"The report compiles data from three surveys.", ja:"ãã®å ±å‘Šæ›¸ã¯3ã¤ã®èª¿æŸ»ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚" },
    { en:"They implemented a new security system.", ja:"å½¼ã‚‰ã¯æ–°ã—ã„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿæ–½ã—ã¾ã—ãŸã€‚" },
    { en:"Please conserve energy after hours.", ja:"å–¶æ¥­æ™‚é–“å¤–ã¯ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ç¯€ç´„ã—ã¦ãã ã•ã„ã€‚" },
    { en:"We evaluate projects every quarter.", ja:"æˆ‘ã€…ã¯å››åŠæœŸã”ã¨ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è©•ä¾¡ã—ã¾ã™ã€‚" },
    { en:"The machine requires regular maintenance.", ja:"ãã®æ©Ÿæ¢°ã«ã¯å®šæœŸçš„ãªä¿å®ˆãŒå¿…è¦ã§ã™ã€‚" },
    { en:"He assumed the role of team leader.", ja:"å½¼ã¯ãƒãƒ¼ãƒ ãƒªãƒ¼ãƒ€ãƒ¼ã®å½¹å‰²ã‚’å¼•ãå—ã‘ã¾ã—ãŸã€‚" },
    { en:"Results remain consistent across tests.", ja:"çµæœã¯ãƒ†ã‚¹ãƒˆå…¨ä½“ã§ä¸€è²«ã—ã¦ã„ã¾ã™ã€‚" },
    { en:"The event was suspended due to the weather.", ja:"å¤©å€™ã®ãŸã‚ã‚¤ãƒ™ãƒ³ãƒˆã¯ä¸€æ™‚ä¸­æ­¢ã«ãªã‚Šã¾ã—ãŸã€‚" },
    { en:"Encourage customers to leave feedback.", ja:"é¡§å®¢ã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®è¨˜å…¥ã‚’ä¿ƒã—ã¦ãã ã•ã„ã€‚" },
    { en:"We accomplished our yearly targets.", ja:"å¹´é–“ç›®æ¨™ã‚’é”æˆã—ã¾ã—ãŸã€‚" },
    { en:"The estimate is approximately ten percent lower.", ja:"è¦‹ç©ã‚‚ã‚Šã¯ãŠã‚ˆã10%ä½ããªã£ã¦ã„ã¾ã™ã€‚" }
  ];

  const QA = [
    { q_en:"What does 'allocate' mean in project management?", a_en:"To assign resources, time, or money to tasks.", q_ja:"ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã§ã®ã€allocateã€ã¯ä½•ã‚’æ„å‘³ã—ã¾ã™ã‹ï¼Ÿ", a_ja:"è³‡æºãƒ»æ™‚é–“ãƒ»è³‡é‡‘ã‚’ã‚¿ã‚¹ã‚¯ã«å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã€‚" },
    { q_en:"When should you confirm a meeting?", a_en:"After the date/time is set and before the day of the meeting.", q_ja:"ä¼šè­°ã¯ã„ã¤ç¢ºèªã™ã¹ãã§ã™ã‹ï¼Ÿ", a_ja:"æ—¥æ™‚ãŒæ±ºã¾ã£ãŸå¾Œã§ã€å½“æ—¥ã‚ˆã‚Šå‰ã«ç¢ºèªã™ã‚‹ã€‚" },
    { q_en:"Why conserve energy at the office?", a_en:"To reduce costs and environmental impact.", q_ja:"ãªãœã‚ªãƒ•ã‚£ã‚¹ã§ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ç¯€ç´„ã™ã‚‹ã®ã§ã™ã‹ï¼Ÿ", a_ja:"ã‚³ã‚¹ãƒˆã¨ç’°å¢ƒè² è·ã‚’æ¸›ã‚‰ã™ãŸã‚ã€‚" },
    { q_en:"What is consistent performance?", a_en:"Results that are stable and reliable over time.", q_ja:"ä¸€è²«ã—ãŸæ¥­ç¸¾ã¨ã¯ï¼Ÿ", a_ja:"æ™‚é–“ãŒçµŒã£ã¦ã‚‚å®‰å®šãƒ»ä¿¡é ¼ã§ãã‚‹æˆæœã€‚" },
    { q_en:"How do teams collaborate online?", a_en:"Using shared tools like chat, docs, and task boards.", q_ja:"ãƒãƒ¼ãƒ ã¯ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§ã©ã†å”åŠ›ã—ã¾ã™ã‹ï¼Ÿ", a_ja:"ãƒãƒ£ãƒƒãƒˆã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€ã‚¿ã‚¹ã‚¯ãƒœãƒ¼ãƒ‰ãªã©ã®å…±æœ‰ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã†ã€‚" },
    { q_en:"What does it mean to implement a plan?", a_en:"To execute it in practice.", q_ja:"è¨ˆç”»ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã¯ï¼Ÿ", a_ja:"å®Ÿéš›ã«å®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚" },
    { q_en:"When might a company suspend operations?", a_en:"During emergencies or system maintenance.", q_ja:"ä¼šç¤¾ãŒæ¥­å‹™ã‚’åœæ­¢ã™ã‚‹ã®ã¯ã„ã¤ï¼Ÿ", a_ja:"ç·Šæ€¥æ™‚ã‚„ã‚·ã‚¹ãƒ†ãƒ ä¿å®ˆã®é–“ã€‚" },
    { q_en:"How do you evaluate a vendor?", a_en:"By price, quality, reliability, and service.", q_ja:"ãƒ™ãƒ³ãƒ€ãƒ¼ã‚’ã©ã†è©•ä¾¡ã—ã¾ã™ã‹ï¼Ÿ", a_ja:"ä¾¡æ ¼ãƒ»å“è³ªãƒ»ä¿¡é ¼æ€§ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã§è©•ä¾¡ã™ã‚‹ã€‚" },
    { q_en:"What does 'assume responsibility' imply?", a_en:"You accept the duty and its consequences.", q_ja:"ã€è²¬ä»»ã‚’å¼•ãå—ã‘ã‚‹ã€ã¨ã¯ï¼Ÿ", a_ja:"è²¬ä»»ã¨ãã®çµæœã‚’å¼•ãå—ã‘ã‚‹ã“ã¨ã€‚" },
    { q_en:"What is the capacity of a venue?", a_en:"The maximum number of people it can hold.", q_ja:"ä¼šå ´ã®åå®¹äººæ•°ã¨ã¯ï¼Ÿ", a_ja:"åå®¹å¯èƒ½ãªæœ€å¤§äººæ•°ã€‚" },
    { q_en:"Why clarify instructions?", a_en:"To prevent mistakes and delays.", q_ja:"æŒ‡ç¤ºã‚’æ˜ç¢ºã«ã™ã‚‹ç†ç”±ã¯ï¼Ÿ", a_ja:"ãƒŸã‚¹ã¨é…å»¶ã‚’é˜²ããŸã‚ã€‚" },
    { q_en:"How can managers encourage staff?", a_en:"By recognizing efforts and offering support.", q_ja:"ç®¡ç†è·ã¯ã©ã†ã‚„ã£ã¦è·å“¡ã‚’åŠ±ã¾ã™ï¼Ÿ", a_ja:"åŠªåŠ›ã‚’èªã‚ã€æ”¯æ´ã‚’æä¾›ã™ã‚‹ã€‚" },
    { q_en:"What does 'compile a report' involve?", a_en:"Collecting and organizing information.", q_ja:"ã€å ±å‘Šæ›¸ã‚’ã¾ã¨ã‚ã‚‹ã€ã¨ã¯ï¼Ÿ", a_ja:"æƒ…å ±ã‚’åé›†ã—æ•´ç†ã™ã‚‹ã“ã¨ã€‚" },
    { q_en:"When do sales typically decline?", a_en:"During off-peak seasons or recessions.", q_ja:"å£²ä¸ŠãŒè½ã¡ã‚„ã™ã„æ™‚æœŸã¯ï¼Ÿ", a_ja:"é–‘æ•£æœŸã‚„ä¸æ³ã®ã¨ãã€‚" },
    { q_en:"What is approximately ten minutes?", a_en:"About eight to twelve minutes.", q_ja:"ã€ç´„10åˆ†ã€ã¨ã¯ï¼Ÿ", a_ja:"8ã€œ12åˆ†ç¨‹åº¦ã€‚" },
    { q_en:"Why be cautious with emails?", a_en:"To avoid scams and data leaks.", q_ja:"ãƒ¡ãƒ¼ãƒ«ã«æ³¨æ„ã™ã¹ãç†ç”±ã¯ï¼Ÿ", a_ja:"è©æ¬ºã‚„æƒ…å ±æ¼ãˆã„ã‚’é¿ã‘ã‚‹ãŸã‚ã€‚" },
    { q_en:"How do you maintain equipment?", a_en:"Clean, inspect, and service it regularly.", q_ja:"è¨­å‚™ã®ç¶­æŒæ–¹æ³•ã¯ï¼Ÿ", a_ja:"å®šæœŸçš„ã«æ¸…æƒãƒ»ç‚¹æ¤œãƒ»æ•´å‚™ã™ã‚‹ã€‚" },
    { q_en:"Who can authorize expenses?", a_en:"Supervisors or finance departments.", q_ja:"è²»ç”¨ã‚’æ‰¿èªã§ãã‚‹ã®ã¯èª°ï¼Ÿ", a_ja:"ä¸Šé•·ã‚„çµŒç†éƒ¨é–€ã€‚" },
    { q_en:"What does 'accomplish a task' mean?", a_en:"Finish it successfully.", q_ja:"ã€ã‚¿ã‚¹ã‚¯ã‚’é”æˆã™ã‚‹ã€ã¨ã¯ï¼Ÿ", a_ja:"ã†ã¾ãã‚„ã‚Šé‚ã’ã‚‹ã“ã¨ã€‚" },
    { q_en:"What happens when teams fail to collaborate?", a_en:"Work is duplicated and deadlines are missed.", q_ja:"å”åŠ›ã§ããªã„ã¨ä½•ãŒèµ·ãã‚‹ï¼Ÿ", a_ja:"ä½œæ¥­ã®é‡è¤‡ã‚„ç· åˆ‡é…å»¶ãŒèµ·ãã‚‹ã€‚" }
  ];

  const QUIZ = [
    { q:"'Allocate' is closest in meaning to:", options:["distribute","repair","delay","dismiss"], answer:0, ja:"ã€allocateã€ã«æœ€ã‚‚è¿‘ã„æ„å‘³ã¯ï¼Ÿ" },
    { q:"'Approximately' means:", options:["exactly","about","rarely","equally"], answer:1, ja:"ã€approximatelyã€ã®æ„å‘³ã¯ï¼Ÿ" },
    { q:"To 'assemble' equipment is to:", options:["store it","build it","ship it","return it"], answer:1, ja:"æ©Ÿå™¨ã‚’ã€assembleã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"'Authorize' most nearly means:", options:["approve","argue","announce","avoid"], answer:0, ja:"ã€authorizeã€ã®æ„å‘³ã«æœ€ã‚‚è¿‘ã„ã®ã¯ï¼Ÿ" },
    { q:"'Capacity' refers to:", options:["cost of labor","maximum ability","average time","customer review"], answer:1, ja:"ã€capacityã€ã¯ä½•ã‚’æŒ‡ã™ï¼Ÿ" },
    { q:"A 'cautious' approach is:", options:["careless","patient","careful","creative"], answer:2, ja:"ã€cautiousã€ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ï¼Ÿ" },
    { q:"To 'clarify' instructions is to:", options:["shorten them","make them clear","ignore them","translate them"], answer:1, ja:"æŒ‡ç¤ºã‚’ã€clarifyã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"Teams 'collaborate' when they:", options:["compete","work together","rotate jobs","work overtime"], answer:1, ja:"ãƒãƒ¼ãƒ ãŒã€collaborateã€ã™ã‚‹ã®ã¯ï¼Ÿ" },
    { q:"To 'compile' data means to:", options:["delete it","compare it","collect it","share it"], answer:2, ja:"ãƒ‡ãƒ¼ã‚¿ã‚’ã€compileã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"To 'confirm' an order is to:", options:["cancel it","verify it","ship it","print it"], answer:1, ja:"æ³¨æ–‡ã‚’ã€confirmã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"To 'conserve' resources is to:", options:["save them","spend them","waste them","audit them"], answer:0, ja:"è³‡æºã‚’ã€conserveã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"'Consistent' results are:", options:["irregular","similar over time","unexpected","declining"], answer:1, ja:"ã€consistentã€ãªçµæœã¨ã¯ï¼Ÿ" },
    { q:"To 'decline' an invitation is to:", options:["accept","postpone","refuse","repeat"], answer:2, ja:"æ‹›å¾…ã‚’ã€declineã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"To 'encourage' staff is to:", options:["criticize","motivate","replace","observe"], answer:1, ja:"è·å“¡ã‚’ã€encourageã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"To 'evaluate' a program is to:", options:["guess","measure","announce","install"], answer:1, ja:"ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã€evaluateã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"To 'implement' a policy is to:", options:["plan it","discuss it","enforce it","oppose it"], answer:2, ja:"æ–¹é‡ã‚’ã€implementã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"To 'maintain' equipment is to:", options:["ignore","repair regularly","sell","relocate"], answer:1, ja:"è¨­å‚™ã‚’ã€maintainã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"To 'assume' a role is to:", options:["reject it","take it on","criticize it","limit it"], answer:1, ja:"å½¹å‰²ã‚’ã€assumeã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"To 'suspend' service is to:", options:["reduce cost","improve quality","pause temporarily","expand rapidly"], answer:2, ja:"ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã€suspendã€ã™ã‚‹ã¨ã¯ï¼Ÿ" },
    { q:"To 'accomplish' a goal is to:", options:["begin it","delay it","achieve it","question it"], answer:2, ja:"ç›®æ¨™ã‚’ã€accomplishã€ã™ã‚‹ã¨ã¯ï¼Ÿ" }
  ];

  // 10 Reading passages aligned to the set
  const READING = [
    { en:"Our team collaborated across departments to compile last quarterâ€™s sales data and clarify the main reasons for the decline.", ja:"ç§ãŸã¡ã®ãƒãƒ¼ãƒ ã¯éƒ¨é–€æ¨ªæ–­ã§å”åŠ›ã—ã€å…ˆå››åŠæœŸã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’ã¾ã¨ã‚ã€æ¸›å°‘ã®ä¸»ãªç†ç”±ã‚’æ˜ç¢ºã«ã—ã¾ã—ãŸã€‚" },
    { en:"Management authorized a new policy to conserve energy after hours and maintain consistent security procedures.", ja:"çµŒå–¶é™£ã¯ã€å–¶æ¥­æ™‚é–“å¤–ã®çœã‚¨ãƒã¨ä¸€è²«ã—ãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ‰‹é †ã®ç¶­æŒã«é–¢ã™ã‚‹æ–°æ–¹é‡ã‚’æ‰¿èªã—ã¾ã—ãŸã€‚" },
    { en:"We must allocate sufficient budget and capacity before we implement the international marketing plan.", ja:"å›½éš›ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°è¨ˆç”»ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«ã€ååˆ†ãªäºˆç®—ã¨åå®¹èƒ½åŠ›ã‚’å‰²ã‚Šå½“ã¦ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚" },
    { en:"The parts arrive approximately at noon, so the assembly line can resume after lunch.", ja:"éƒ¨å“ã¯æ­£åˆã”ã‚ã«åˆ°ç€ã™ã‚‹ã®ã§ã€çµ„ç«‹ãƒ©ã‚¤ãƒ³ã¯æ˜¼é£Ÿå¾Œã«å†é–‹ã§ãã¾ã™ã€‚" },
    { en:"Please confirm the vendorâ€™s maintenance schedule to avoid any suspension of service.", ja:"ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢ã‚’é¿ã‘ã‚‹ãŸã‚ã€ãƒ™ãƒ³ãƒ€ãƒ¼ã®ä¿å®ˆäºˆå®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚" },
    { en:"Supervisors encourage staff to evaluate risks carefully and be cautious with unfamiliar email attachments.", ja:"ä¸Šé•·ã¯ã€è·å“¡ãŒãƒªã‚¹ã‚¯ã‚’æ…é‡ã«è©•ä¾¡ã—ã€è¦‹æ…£ã‚Œãªã„ãƒ¡ãƒ¼ãƒ«æ·»ä»˜ã«æ³¨æ„ã™ã‚‹ã‚ˆã†ä¿ƒã—ã¦ã„ã¾ã™ã€‚" },
    { en:"To accomplish our goals, we assumed new roles and collaborated closely with the finance team.", ja:"ç›®æ¨™ã‚’é”æˆã™ã‚‹ãŸã‚ã«ã€æ–°ã—ã„å½¹å‰²ã‚’å¼•ãå—ã‘ã€è²¡å‹™ãƒãƒ¼ãƒ ã¨ç·Šå¯†ã«é€£æºã—ã¾ã—ãŸã€‚" },
    { en:"The report compiles customer feedback to clarify which features we should implement next.", ja:"å ±å‘Šæ›¸ã¯é¡§å®¢ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ã¾ã¨ã‚ã€æ¬¡ã«å®Ÿè£…ã™ã¹ãæ©Ÿèƒ½ã‚’æ˜ç¢ºã«ã—ã¾ã™ã€‚" },
    { en:"Due to weather concerns, the event was suspended, but capacity planning for the next date has already begun.", ja:"å¤©å€™ã®å•é¡Œã§ã‚¤ãƒ™ãƒ³ãƒˆã¯ä¸€æ™‚ä¸­æ­¢ã¨ãªã‚Šã¾ã—ãŸãŒã€æ¬¡å›ã«å‘ã‘ãŸåå®¹è¨ˆç”»ã¯ã™ã§ã«å§‹ã¾ã£ã¦ã„ã¾ã™ã€‚" },
    { en:"Regular evaluations help maintain consistent quality and conserve resources across projects.", ja:"å®šæœŸçš„ãªè©•ä¾¡ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§ä¸€è²«ã—ãŸå“è³ªã®ç¶­æŒã¨è³‡æºã®ç¯€ç´„ã«å½¹ç«‹ã¡ã¾ã™ã€‚" }
  ];

  // QA assets (exact filenames/paths you provided)
  const QA_IMAGES = Array.from({length:20}, (_,i)=> `${i+1}.jpg`);
  const QA_AUDIOS = Array.from({length:20}, (_,i)=> `assets/A${i+1}.m4a`);

  // ---------- STATE / ELEMENTS ----------
  let deck = [];
  let index = 0;
  let showingFront = true;

  const els = {
    welcome: document.getElementById('welcome'),
    app: document.getElementById('app'),
    mode: document.getElementById('mode'),
    card: document.getElementById('card'),
    label: document.getElementById('label'),
    main: document.getElementById('main'),
    sub: document.getElementById('sub'),
    hira: document.getElementById('hira'),
    counter: document.getElementById('counter'),
    btnPrev: document.getElementById('btnPrev'),
    btnNext: document.getElementById('btnNext'),
    btnFlip: document.getElementById('btnFlip'),
    btnShuffle: document.getElementById('btnShuffle'),
    mcArea: document.getElementById('mcArea'),
    pic: document.getElementById('pic'),
    bar: document.getElementById('bar'),
    btnPlay: document.getElementById('btnPlay'),
    btnSpeed: document.getElementById('btnSpeed'),
    qaAudio: document.getElementById('qaAudio'),
  };

  function shuffleArr(arr){
    for(let i=arr.length-1;i>0;i--){
      const j=Math.floor(Math.random()*(i+1));
      [arr[i],arr[j]]=[arr[j],arr[i]];
    }
    return arr;
  }

  // Show/hide QA controls
  function showQAControls(show){
    const qaButtons = [els.btnPlay, els.btnSpeed];
    qaButtons.forEach(btn=>{
      if(!btn) return;
      btn.style.display = show ? 'inline-block' : 'none';
    });

    if(show){
      const item = deck[index];
      const hasAudio = item && !!item.audio;
      els.btnPlay.disabled = !hasAudio;
      els.btnSpeed.disabled = !hasAudio;
    } else {
      els.qaAudio.pause();
      els.btnPlay.classList.remove('playing');
      els.btnPlay.classList.add('paused');
    }
  }

  // Build deck by mode
  function buildDeck(){
    const mode = els.mode.value;
    if(mode==='vocab-j2e' || mode==='vocab-e2j'){
      deck = VOCAB.map(x=>({
        type:'vocab',
        front: mode==='vocab-j2e' ? x.ja : x.en,
        back:  mode==='vocab-j2e' ? x.en : x.ja,
        sideLabelFront: mode==='vocab-j2e' ? 'Japanese â†’ English' : 'English â†’ Japanese',
        sideLabelBack:  mode==='vocab-j2e' ? 'English' : 'Japanese',
      }));
    } else if(mode==='sentences'){
      deck = SENTENCES.map(s=>({
        type:'sentence',
        front:s.ja,
        back:s.en+'\n'+s.ja,
        sideLabelFront:'Japanese sentence',
        sideLabelBack:'Answer (EN + JA)'
      }));
    } else if(mode==='qa'){
      deck = QA.map((q,i)=>({
        type:'qa',
        front:q.q_ja || q.q_en,
        back:(q.a_en||'') + (q.a_ja?'\n'+q.a_ja:''),
        sideLabelFront:(q.q_ja?'Question (JA)':'Question (EN)'),
        sideLabelBack:'Answer (EN + JA)',
        img:QA_IMAGES[i] || null,
        audio:QA_AUDIOS[i] || null
      }));
    } else if(mode==='quiz'){
      deck = QUIZ.map(q=>({
        type:'quiz4',
        front:q.q,
        back:(q.ja?q.ja+'\n':'')+'Answer: '+q.options[q.answer],
        options:q.options,
        answer:q.answer,
        sideLabelFront:'Choose the best answer',
        sideLabelBack:'Explanation'
      }));
    } else if(mode==='reading'){
      deck = READING.map(r=>({
        type:'reading',
        front:r.en,
        back:r.en+'\n'+r.ja,
        sideLabelFront:'Reading (EN)',
        sideLabelBack:'Reading (EN + JA)'
      }));
    }
    index = 0; showingFront = true; render();
  }

  // ---------- QA AUDIO ----------
  const SPEEDS = [0.5, 0.8, 1.0];
  let speedIdx = 2; // default 1.0Ã—

  function updateQAAudio(){
    if(els.mode.value!=='qa' || deck.length===0) return;
    const item = deck[index]; const src = item.audio;
    if(!src){
      els.qaAudio.removeAttribute('src');
      els.btnPlay.disabled = true; els.btnSpeed.disabled = true;
      return;
    }
    els.btnPlay.disabled = false; els.btnSpeed.disabled = false;

    const wasPlaying = !els.qaAudio.paused && !els.qaAudio.ended;
    const abs = (new URL(src, location.href)).href;
    if(els.qaAudio.src !== abs){ els.qaAudio.src = src; }
    els.qaAudio.playbackRate = SPEEDS[speedIdx];
    if(wasPlaying){
      els.qaAudio.play().catch(()=>{ /* autoplay blocked */ });
    }
  }

  function setPlayButtonState(){
    if(els.qaAudio.paused){
      els.btnPlay.classList.remove('playing'); els.btnPlay.classList.add('paused');
    }else{
      els.btnPlay.classList.remove('paused'); els.btnPlay.classList.add('playing');
    }
  }

  // ---------- RENDER ----------
  function render(){
    if(deck.length===0){
      els.main.textContent='â€”'; els.sub.textContent='No cards'; els.counter.textContent='0 / 0';
      showQAControls(false); return;
    }
    const item = deck[index]; const mode = els.mode.value;
    els.label.textContent = showingFront ? item.sideLabelFront : item.sideLabelBack;

    // Image for QA (show on both sides)
    if(item.img){
      els.pic.classList.remove('hidden');
      els.pic.src = item.img;
      els.pic.alt = item.sideLabelFront || 'illustration';
      els.pic.onerror = ()=>{ els.pic.classList.add('hidden'); };
    } else {
      els.pic.classList.add('hidden'); els.pic.removeAttribute('src');
    }

    const content = showingFront ? item.front : item.back;
    if((!showingFront) && (item.type==='qa'||item.type==='sentence'||item.type==='reading') && content.includes('\n')){
      const [line1,line2] = content.split('\n');
      els.main.innerHTML = `<div style="font-size:22px;font-weight:700" class="${item.type==='reading'?'small':''}">${line1}</div><div class="sub ${item.type==='reading'?'small':''}" style="margin-top:8px">${line2}</div>`;
    } else {
      els.main.innerHTML = `<div class="${item.type==='reading'?'small':''}">${content}</div>`;
    }

    // Quiz MC buttons
    if(mode==='quiz' && item.type==='quiz4' && showingFront){
      els.sub.textContent = 'Choose the correct answer.';
      els.mcArea.classList.remove('hidden'); els.mcArea.innerHTML='';
      item.options.forEach((opt,i)=>{
        const b=document.createElement('button'); b.className='optbtn'; b.textContent=opt;
        b.addEventListener('click',(e)=>{
          e.preventDefault(); e.stopPropagation();
          if(i!==item.answer){ b.classList.add('bad'); b.disabled=true; return; }
          b.classList.add('ok'); [...els.mcArea.querySelectorAll('button')].forEach(x=>x.disabled=true);
          setTimeout(()=>{ showingFront=false; render(); },250);
        }, {passive:false});
        els.mcArea.appendChild(b);
      });
    } else {
      els.mcArea.classList.add('hidden'); els.mcArea.innerHTML='';
      els.sub.textContent = (item.type==='quiz4'&&showingFront)?'Choose the correct answer.':'Tap / Space to flip Â· Swipe / â† â†’ to navigate';
    }

    // QA controls toggle + audio refresh
    if(mode==='qa'){
      showQAControls(true);
      els.btnSpeed.textContent = `${SPEEDS[speedIdx].toFixed(1)}Ã—`;
      updateQAAudio();
      setPlayButtonState();
    } else {
      showQAControls(false);
    }

    // Counter / progress
    els.counter.textContent = `${index+1} / ${deck.length}`;
    const pct = ((index+1)/deck.length)*100; els.bar.style.width = `${pct}%`;

    // Update deep link
    location.hash = `#${els.mode.value}:${index}`;
  }

  // ---------- NAV ----------
  function prev(){ index=(index-1+deck.length)%deck.length; showingFront=true; render(); }
  function next(){ index=(index+1)%deck.length; showingFront=true; render(); }
  function flip(){ if(!(els.mode.value==='quiz' && showingFront)) { showingFront=!showingFront; render(); } }
  function shuffleDeck(){ deck = shuffleArr(deck); index = 0; showingFront = true; render(); }

  // ---------- STARTUP ----------
  function startApp(){
    try{
      // Honor deep link mode if present; otherwise default to QA
      const h = location.hash.replace('#','');
      const askMode = h && h.split(':')[0];
      if(els.mode) els.mode.value = (askMode && [...els.mode.options].some(o=>o.value===askMode)) ? askMode : 'qa';

      index = 0; showingFront = true;
      buildDeck();

      // Show UI
      els.app.classList.remove('hidden');
      els.app.removeAttribute('aria-hidden');

      // Hide welcome overlay
      els.welcome.classList.add('hidden');
      els.welcome.setAttribute('aria-hidden','true');
      els.welcome.style.display = 'none';
      els.welcome.style.visibility = 'hidden';
      els.welcome.style.pointerEvents = 'none';

      // Lock URL to current mode/index
      location.hash = `#${els.mode.value}:0`;
    }catch(err){
      console.error('startApp error:', err);
      els.app.classList.remove('hidden');
      els.welcome.classList.add('hidden'); els.welcome.style.display='none';
      if(els.mode) els.mode.value = 'qa';
      index = 0; buildDeck(); location.hash = '#qa:0';
    }
  }
  window.startApp = startApp;

  // ---------- BINDINGS ----------
  document.addEventListener('DOMContentLoaded', ()=>{
    // Start button (still usable)
    const startBtn = document.getElementById('startBtn');
    if(startBtn){ startBtn.addEventListener('click', (e)=>{ e.preventDefault(); startApp(); }); }

    // Autostart so youâ€™re never stuck at 0/0
    startApp();

    // Controls
    els.btnPrev.addEventListener('click', (e)=>{ e.preventDefault(); prev(); });
    els.btnNext.addEventListener('click', (e)=>{ e.preventDefault(); next(); });
    els.btnFlip.addEventListener('click', (e)=>{ e.preventDefault(); flip(); });
    els.btnShuffle.addEventListener('click', (e)=>{ e.preventDefault(); shuffleDeck(); });
    els.mode.addEventListener('change', ()=>{ buildDeck(); });

    // Card interactions
    els.card.addEventListener('click', ()=> flip());
    document.addEventListener('keydown', (e)=>{
      if(e.code==='Space'){ e.preventDefault(); flip(); }
      if(e.key==='ArrowLeft'){ prev(); }
      if(e.key==='ArrowRight'){ next(); }
    });

    // QA audio controls
    els.btnPlay.addEventListener('click', ()=>{
      if(els.qaAudio.paused){
        els.qaAudio.play().catch(()=>{ /* autoplay blocked: user can press again */ });
      } else {
        els.qaAudio.pause();
      }
      setPlayButtonState();
    });
    els.btnSpeed.addEventListener('click', ()=>{
      speedIdx = (speedIdx+1)%SPEEDS.length;
      els.qaAudio.playbackRate = SPEEDS[speedIdx];
      els.btnSpeed.textContent = `${SPEEDS[speedIdx].toFixed(1)}Ã—`;
    });
    els.qaAudio.addEventListener('play', setPlayButtonState);
    els.qaAudio.addEventListener('pause', setPlayButtonState);
    els.qaAudio.addEventListener('ended', setPlayButtonState);
  });
</script>
</body>
</html>
