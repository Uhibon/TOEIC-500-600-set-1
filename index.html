<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TOEIC (500‚Äì600) ‚Äì Set 1 | Boo‚Äëriculum</title>
  <style>
    :root{--bg:#0b0f14;--card:#121821;--ink:#e6edf3;--muted:#9fb1c6;--accent:#6fd3ff;--accent2:#aef35a;--wrong:#ff6b6b;--right:#3ddc97;--btn:#1f2a38}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;background:linear-gradient(180deg,#0b0f14,#0e141d 30%,#0b0f14);color:var(--ink)}
    .wrap{max-width:980px;margin:32px auto;padding:16px}
    .title{font-size:clamp(22px,3vw,32px);font-weight:800;letter-spacing:.3px;margin:0 0 8px}
    .sub{color:var(--muted);margin:0 0 24px}
    .bar{display:flex;flex-wrap:wrap;gap:8px;margin:0 0 14px}
    .tab{background:var(--btn);color:var(--ink);border:1px solid #263243;padding:8px 12px;border-radius:12px;cursor:pointer;user-select:none}
    .tab.active{outline:2px solid var(--accent)}
    .card{background:var(--card);border:1px solid #1e2733;border-radius:16px;padding:16px;box-shadow:0 8px 30px rgba(0,0,0,.22)}
    .row{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    .btn{background:var(--btn);border:1px solid #273443;color:var(--ink);padding:10px 14px;border-radius:12px;cursor:pointer}
    .btn[disabled]{opacity:.45;cursor:not-allowed}
    .ghost{opacity:.7;color:var(--muted)}
    .big{font-size:clamp(18px,2.2vw,22px);font-weight:700}
    .small{color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-top:14px}
    .chip{border:1px solid #2a394d;border-radius:12px;padding:10px 12px}
    .qa{margin:10px 0}
    .opt{display:block;width:100%;text-align:left;margin:8px 0;padding:10px 12px;border-radius:12px;border:1px solid #2a394d;background:#141b26;cursor:pointer}
    .opt.wrong{background:#2a1416;border-color:#5a1e24;color:#ffb6b6}
    .opt.right{background:#13291f;border-color:#1f5a3c;color:#c9ffe6}
    .flex{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .progress{height:10px;background:#0f141d;border:1px solid #1e2733;border-radius:999px;overflow:hidden}
    .progress>div{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));width:0%}
    .kbd{font-family:ui-monospace,Consolas,Menlo,monospace;background:#0e141d;border:1px solid #263243;border-radius:8px;padding:2px 6px;color:#b7c7d8}
    .note{font-size:13px;color:#8aa2b7}
  </style>
</head>
<body>
  <div class="wrap">
    <h1 class="title">TOEIC (500‚Äì600) ‚Äì Set 1</h1>
    <p class="sub">Modes: Vocab J‚ÜíE / Vocab E‚ÜíJ / Sentences / Q&A / Quiz. 
      Wrong quiz answers stay <span style="color:var(--wrong);font-weight:700">red</span>; you must choose the correct answer (<span style="color:var(--right);font-weight:700">green</span>) before moving on.
    </p>
    <div class="bar" id="modeBar"></div>
    <div class="card" id="stage"></div>
  </div>

  <script>
    // -------------------- DATA (500‚Äì600) SET 1 --------------------
    const vocab = [
      {en:"accomplish", jp:"ÈÅîÊàê„Åô„Çã"},
      {en:"allocate", jp:"Ââ≤„ÇäÂΩì„Å¶„Çã"},
      {en:"approximately", jp:"„Åä„Çà„ÅùÔºèÁ¥Ñ"},
      {en:"assemble", jp:"ÁµÑ„ÅøÁ´ã„Å¶„ÇãÔºõÈõÜ„ÇÅ„Çã"},
      {en:"assume", jp:"‰ªÆÂÆö„Åô„ÇãÔºõÂºï„ÅçÂèó„Åë„Çã"},
      {en:"authorize", jp:"ÊâøË™ç„Åô„ÇãÔºõË™çÂèØ„Åô„Çã"},
      {en:"capacity", jp:"ËÉΩÂäõÔºõÂèéÂÆπËÉΩÂäõ"},
      {en:"cautious", jp:"Áî®ÂøÉÊ∑±„ÅÑÔºõÊÖéÈáç„Å™"},
      {en:"clarify", jp:"ÊòéÁ¢∫„Å´„Åô„Çã"},
      {en:"collaborate", jp:"ÂçîÂäõ„Åô„ÇãÔºõÂÖ±Âêå„ÅßË°å„ÅÜ"},
      {en:"compile", jp:"„Åæ„Å®„ÇÅ„ÇãÔºõÁ∑®ÈõÜ„Åô„Çã"},
      {en:"confirm", jp:"Á¢∫Ë™ç„Åô„Çã"},
      {en:"conserve", jp:"ÁØÄÁ¥Ñ„Åô„ÇãÔºõ‰øùÂ≠ò„Åô„Çã"},
      {en:"consistent", jp:"‰∏ÄË≤´„Åó„ÅüÔºõÁüõÁõæ„ÅÆ„Å™„ÅÑ"},
      {en:"decline", jp:"Êñ≠„ÇãÔºõÊ∏õÂ∞ë„Åô„Çã"},
      {en:"encourage", jp:"Âä±„Åæ„ÅôÔºõ‰øÉ„Åô"},
      {en:"evaluate", jp:"Ë©ï‰æ°„Åô„Çã"},
      {en:"implement", jp:"ÂÆüË°å„Åô„ÇãÔºõÂÆüÊñΩ„Åô„Çã"},
      {en:"maintain", jp:"Á∂≠ÊåÅ„Åô„ÇãÔºõ‰∏ªÂºµ„Åô„Çã"},
      {en:"suspend", jp:"‰∏ÄÊôÇÂÅúÊ≠¢„Åô„ÇãÔºõ‰øùÁïô„Å´„Åô„Çã"}
    ];

    const sentences = [
      {en:"We need to allocate more time to training.", jp:"Á†î‰øÆ„Å´„ÇÇ„Å£„Å®ÊôÇÈñì„ÇíÂâ≤„ÇäÂΩì„Å¶„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ"},
      {en:"The parts are easy to assemble with the manual.", jp:"„Åù„ÅÆÈÉ®ÂìÅ„ÅØÂèñÊâ±Ë™¨ÊòéÊõ∏„ÅßÁ∞°Âçò„Å´ÁµÑ„ÅøÁ´ã„Å¶„Çâ„Çå„Åæ„Åô„ÄÇ"},
      {en:"Please confirm your attendance by Friday.", jp:"ÈáëÊõúÊó•„Åæ„Åß„Å´Âá∫Ê¨†„Çí„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ"},
      {en:"Sales declined slightly last quarter.", jp:"ÂÖàÂõõÂçäÊúü„Å´Â£≤‰∏ä„ÅØ„Çè„Åö„Åã„Å´Ê∏õÂ∞ë„Åó„Åæ„Åó„Åü„ÄÇ"},
      {en:"Her explanation clarified the policy.", jp:"ÂΩºÂ•≥„ÅÆË™¨Êòé„ÅßÊñπÈáù„ÅåÊòéÁ¢∫„Å´„Å™„Çä„Åæ„Åó„Åü„ÄÇ"},
      {en:"The company authorized the refund.", jp:"‰ºöÁ§æ„ÅØËøîÈáë„ÇíÊâøË™ç„Åó„Åæ„Åó„Åü„ÄÇ"},
      {en:"Our factory operates at full capacity in summer.", jp:"ÂΩìÂ∑•Â†¥„ÅØÂ§è„Å´ÊúÄÂ§ßÁ®ºÂÉç„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ"},
      {en:"Be cautious when signing the contract.", jp:"Â•ëÁ¥Ñ„Å´ÁΩ≤Âêç„Åô„ÇãÈöõ„ÅØÊÖéÈáç„Å´„Å™„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ"},
      {en:"We will collaborate with a local supplier.", jp:"Âú∞ÂÖÉ„ÅÆ„Çµ„Éó„É©„Ç§„É§„Éº„Å®ÂçîÂäõ„Åó„Åæ„Åô„ÄÇ"},
      {en:"The report compiles data from three surveys.", jp:"„Åù„ÅÆÂ†±ÂëäÊõ∏„ÅØ3„Å§„ÅÆË™øÊüª„Åã„Çâ„ÅÆ„Éá„Éº„Çø„Çí„Åæ„Å®„ÇÅ„Å¶„ÅÑ„Åæ„Åô„ÄÇ"},
      {en:"They implemented a new security system.", jp:"ÂΩº„Çâ„ÅØÊñ∞„Åó„ÅÑ„Çª„Ç≠„É•„É™„ÉÜ„Ç£„Ç∑„Çπ„ÉÜ„É†„ÇíÂÆüÊñΩ„Åó„Åæ„Åó„Åü„ÄÇ"},
      {en:"Please conserve energy after hours.", jp:"Âñ∂Ê•≠ÊôÇÈñìÂ§ñ„ÅØ„Ç®„Éç„É´„ÇÆ„Éº„ÇíÁØÄÁ¥Ñ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ"},
      {en:"We evaluate projects every quarter.", jp:"Êàë„ÄÖ„ÅØÂõõÂçäÊúü„Åî„Å®„Å´„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíË©ï‰æ°„Åó„Åæ„Åô„ÄÇ"},
      {en:"The machine requires regular maintenance.", jp:"„Åù„ÅÆÊ©üÊ¢∞„Å´„ÅØÂÆöÊúüÁöÑ„Å™‰øùÂÆà„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ"},
      {en:"He assumed the role of team leader.", jp:"ÂΩº„ÅØ„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº„ÅÆÂΩπÂâ≤„ÇíÂºï„ÅçÂèó„Åë„Åæ„Åó„Åü„ÄÇ"},
      {en:"Results remain consistent across tests.", jp:"ÁµêÊûú„ÅØ„ÉÜ„Çπ„ÉàÂÖ®‰Ωì„Åß‰∏ÄË≤´„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ"},
      {en:"The event was suspended due to the weather.", jp:"Â§©ÂÄô„ÅÆ„Åü„ÇÅ„Ç§„Éô„É≥„Éà„ÅØ‰∏ÄÊôÇ‰∏≠Ê≠¢„Å´„Å™„Çä„Åæ„Åó„Åü„ÄÇ"},
      {en:"Encourage customers to leave feedback.", jp:"È°ßÂÆ¢„Å´„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ„ÅÆË®òÂÖ•„Çí‰øÉ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ"},
      {en:"We accomplished our yearly targets.", jp:"Âπ¥ÈñìÁõÆÊ®ô„ÇíÈÅîÊàê„Åó„Åæ„Åó„Åü„ÄÇ"},
      {en:"The estimate is approximately ten percent lower.", jp:"Ë¶ãÁ©ç„ÇÇ„Çä„ÅØ„Åä„Çà„Åù10%‰Ωé„Åè„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ"}
    ];

    const qa = [
      {q:"What does 'allocate' mean in project management?", a:"To assign resources, time, or money to tasks.", jp:"„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÁÆ°ÁêÜ„Åß„ÅÆ„Äéallocate„Äè„ÅØ„ÄÅË≥áÊ∫ê„ÉªÊôÇÈñì„ÉªË≥áÈáë„Çí„Çø„Çπ„ÇØ„Å´Ââ≤„ÇäÂΩì„Å¶„Çã„Åì„Å®„ÄÇ"},
      {q:"When should you confirm a meeting?", a:"After the date/time is set and before the day of the meeting.", jp:"Êó•ÊôÇ„ÅåÊ±∫„Åæ„Å£„ÅüÂæå„Åß„ÄÅÂΩìÊó•„Çà„ÇäÂâç„Å´Á¢∫Ë™ç„Åô„Çã„ÄÇ"},
      {q:"Why conserve energy at the office?", a:"To reduce costs and environmental impact.", jp:"„Ç≥„Çπ„Éà„Å®Áí∞Â¢ÉË≤†Ëç∑„ÇíÊ∏õ„Çâ„Åô„Åü„ÇÅ„ÄÇ"},
      {q:"What is consistent performance?", a:"Results that are stable and reliable over time.", jp:"ÊôÇÈñì„ÅåÁµå„Å£„Å¶„ÇÇÂÆâÂÆö„Éª‰ø°È†º„Åß„Åç„ÇãÊàêÊûú„ÄÇ"},
      {q:"How do teams collaborate online?", a:"Using shared tools like chat, docs, and task boards.", jp:"„ÉÅ„É£„ÉÉ„Éà„ÄÅ„Éâ„Ç≠„É•„É°„É≥„Éà„ÄÅ„Çø„Çπ„ÇØ„Éú„Éº„Éâ„Å™„Å©„ÅÆÂÖ±Êúâ„ÉÑ„Éº„É´„Çí‰Ωø„ÅÜ„ÄÇ"},
      {q:"What does it mean to implement a plan?", a:"To execute it in practice.", jp:"ÂÆüÈöõ„Å´ÂÆüË°å„Åô„Çã„Åì„Å®„ÄÇ"},
      {q:"When might a company suspend operations?", a:"During emergencies or system maintenance.", jp:"Á∑äÊÄ•ÊôÇ„ÇÑ„Ç∑„Çπ„ÉÜ„É†‰øùÂÆà„ÅÆÈñì„ÄÇ"},
      {q:"How do you evaluate a vendor?", a:"By price, quality, reliability, and service.", jp:"‰æ°Ê†º„ÉªÂìÅË≥™„Éª‰ø°È†ºÊÄß„Éª„Çµ„Éº„Éì„Çπ„ÅßË©ï‰æ°„Åô„Çã„ÄÇ"},
      {q:"What does 'assume responsibility' imply?", a:"You accept the duty and its consequences.", jp:"Ë≤¨‰ªª„Å®„Åù„ÅÆÁµêÊûú„ÇíÂºï„ÅçÂèó„Åë„Çã„Åì„Å®„ÄÇ"},
      {q:"What is the capacity of a venue?", a:"The maximum number of people it can hold.", jp:"ÂèéÂÆπÂèØËÉΩ„Å™ÊúÄÂ§ß‰∫∫Êï∞„ÄÇ"},
      {q:"Why clarify instructions?", a:"To prevent mistakes and delays.", jp:"„Éü„Çπ„Å®ÈÅÖÂª∂„ÇíÈò≤„Åê„Åü„ÇÅ„ÄÇ"},
      {q:"How can managers encourage staff?", a:"By recognizing efforts and offering support.", jp:"Âä™Âäõ„ÇíË™ç„ÇÅ„ÄÅÊîØÊè¥„ÇíÊèê‰æõ„Åô„Çã„ÄÇ"},
      {q:"What does 'compile a report' involve?", a:"Collecting and organizing information.", jp:"ÊÉÖÂ†±„ÇíÂèéÈõÜ„ÅóÊï¥ÁêÜ„Åô„Çã„Åì„Å®„ÄÇ"},
      {q:"When do sales typically decline?", a:"During off-peak seasons or recessions.", jp:"ÈñëÊï£Êúü„ÇÑ‰∏çÊ≥Å„ÅÆ„Å®„Åç„ÄÇ"},
      {q:"What is approximately ten minutes?", a:"About eight to twelve minutes.", jp:"8„Äú12ÂàÜÁ®ãÂ∫¶„ÄÇ"},
      {q:"Why be cautious with emails?", a:"To avoid scams and data leaks.", jp:"Ë©êÊ¨∫„ÇÑÊÉÖÂ†±Êºè„Åà„ÅÑ„ÇíÈÅø„Åë„Çã„Åü„ÇÅ„ÄÇ"},
      {q:"How do you maintain equipment?", a:"Clean, inspect, and service it regularly.", jp:"ÂÆöÊúüÁöÑ„Å´Ê∏ÖÊéÉ„ÉªÁÇπÊ§ú„ÉªÊï¥ÂÇô„Åô„Çã„ÄÇ"},
      {q:"Who can authorize expenses?", a:"Supervisors or finance departments.", jp:"‰∏äÈï∑„ÇÑÁµåÁêÜÈÉ®ÈñÄ„ÄÇ"},
      {q:"What does 'accomplish a task' mean?", a:"Finish it successfully.", jp:"„ÅÜ„Åæ„Åè„ÇÑ„ÇäÈÅÇ„Åí„Çã„Åì„Å®„ÄÇ"},
      {q:"What happens when teams fail to collaborate?", a:"Work is duplicated and deadlines are missed.", jp:"‰ΩúÊ•≠„ÅÆÈáçË§á„ÇÑÁ∑†ÂàáÈÅÖÂª∂„ÅåËµ∑„Åç„Çã„ÄÇ"}
    ];

    const quiz = [
      {q:"'Allocate' is closest in meaning to:", options:["distribute","repair","delay","dismiss"], answer:0},
      {q:"'Approximately' means:", options:["exactly","about","rarely","equally"], answer:1},
      {q:"To 'assemble' equipment is to:", options:["store it","build it","ship it","return it"], answer:1},
      {q:"'Authorize' most nearly means:", options:["approve","argue","announce","avoid"], answer:0},
      {q:"'Capacity' refers to:", options:["cost of labor","maximum ability","average time","customer review"], answer:1},
      {q:"A 'cautious' approach is:", options:["careless","patient","careful","creative"], answer:2},
      {q:"To 'clarify' instructions is to:", options:["shorten them","make them clear","ignore them","translate them"], answer:1},
      {q:"Teams 'collaborate' when they:", options:["compete","work together","rotate jobs","work overtime"], answer:1},
      {q:"To 'compile' data means to:", options:["delete it","compare it","collect it","share it"], answer:2},
      {q:"To 'confirm' an order is to:", options:["cancel it","verify it","ship it","print it"], answer:1},
      {q:"To 'conserve' resources is to:", options:["save them","spend them","waste them","audit them"], answer:0},
      {q:"'Consistent' results are:", options:["irregular","similar over time","unexpected","declining"], answer:1},
      {q:"To 'decline' an invitation is to:", options:["accept","postpone","refuse","repeat"], answer:2},
      {q:"To 'encourage' staff is to:", options:["criticize","motivate","replace","observe"], answer:1},
      {q:"To 'evaluate' a program is to:", options:["guess","measure","announce","install"], answer:1},
      {q:"To 'implement' a policy is to:", options:["plan it","discuss it","enforce it","oppose it"], answer:2},
      {q:"To 'maintain' equipment is to:", options:["ignore","repair regularly","sell","relocate"], answer:1},
      {q:"To 'assume' a role is to:", options:["reject it","take it on","criticize it","limit it"], answer:1},
      {q:"To 'suspend' service is to:", options:["reduce cost","improve quality","pause temporarily","expand rapidly"], answer:2},
      {q:"To 'accomplish' a goal is to:", options:["begin it","delay it","achieve it","question it"], answer:2}
    ];

    // -------------------- APP SHELL --------------------
    const MODES = [
      { id:"vocab-j2e", label:"Vocab J‚ÜíE" },
      { id:"vocab-e2j", label:"Vocab E‚ÜíJ" },
      { id:"sentences", label:"Sentences" },
      { id:"qa", label:"Q&A" },
      { id:"quiz", label:"Quiz" }
    ];

    const stage = document.getElementById('stage');
    const bar = document.getElementById('modeBar');

    let state = {
      mode: MODES[0].id,
      i: 0,
      quizIndex: 0,
      showJP: true,
    };

    function saveHash(){
      location.hash = `${state.mode}:${state.i}`;
    }
    function loadHash(){
      const h = location.hash.replace('#','');
      const [m, idx] = h.split(':');
      if(MODES.some(x=>x.id===m)) state.mode = m;
      state.i = Number(idx||0)||0;
    }

    function renderBar(){
      bar.innerHTML = '';
      MODES.forEach(m=>{
        const b = document.createElement('button');
        b.className = 'tab' + (state.mode===m.id?' active':'');
        b.textContent = m.label;
        b.onclick = ()=>{ state.mode = m.id; state.i = 0; state.quizIndex = 0; saveHash(); render(); };
        bar.appendChild(b);
      });
    }

    function navControls(total){
      const el = document.createElement('div');
      el.className = 'row';
      el.innerHTML = `
        <div class="flex">
          <button class="btn" id="prevBtn">‚óÄ Prev</button>
          <button class="btn" id="nextBtn">Next ‚ñ∂</button>
          <button class="btn" id="randBtn">Shuffle</button>
          <label class="btn" style="display:flex;gap:8px;align-items:center">
            <input type="checkbox" id="jpToggle" ${state.showJP? 'checked':''}/> Êó•Êú¨Ë™û
          </label>
        </div>
        <div class="flex" style="min-width:220px;justify-content:flex-end">
          <div class="progress" style="width:200px"><div style="width:${((state.i+1)/total)*100}%"></div></div>
          <span class="small">${state.i+1} / ${total}</span>
        </div>`;
      el.querySelector('#prevBtn').onclick = ()=>{ state.i = Math.max(0, state.i-1); saveHash(); render(); };
      el.querySelector('#nextBtn').onclick = ()=>{ state.i = Math.min(total-1, state.i+1); saveHash(); render(); };
      el.querySelector('#randBtn').onclick = ()=>{ state.i = Math.floor(Math.random()*total); saveHash(); render(); };
      el.querySelector('#jpToggle').onchange = (e)=>{ state.showJP = e.target.checked; render(); };
      return el;
    }

    function renderVocabJ2E(){
      const total = vocab.length;
      const v = vocab[state.i];
      stage.innerHTML = '';
      stage.appendChild(navControls(total));
      const box = document.createElement('div');
      box.className = 'grid';
      box.innerHTML = `
        <div class="chip">
          <div class="small ghost">Êó•Êú¨Ë™û ‚Üí Ëã±Ë™û</div>
          <div class="big">${state.showJP? v.jp : '‚Ä¢‚Ä¢‚Ä¢'}</div>
          <div class="small">Answer:</div>
          <div class="big" style="color:var(--accent)">${v.en}</div>
        </div>`;
      stage.appendChild(box);
    }

    function renderVocabE2J(){
      const total = vocab.length;
      const v = vocab[state.i];
      stage.innerHTML='';
      stage.appendChild(navControls(total));
      const box = document.createElement('div');
      box.className='grid';
      box.innerHTML = `
        <div class="chip">
          <div class="small ghost">Ëã±Ë™û ‚Üí Êó•Êú¨Ë™û</div>
          <div class="big">${v.en}</div>
          <div class="small">Á≠î„ÅàÔºö</div>
          <div class="big" style="color:var(--accent)">${state.showJP? v.jp : '‚Ä¢‚Ä¢‚Ä¢'}</div>
        </div>`;
      stage.appendChild(box);
    }

    function renderSentences(){
      const total = sentences.length;
      const s = sentences[state.i];
      stage.innerHTML='';
      stage.appendChild(navControls(total));
      const card = document.createElement('div');
      card.className='chip';
      card.innerHTML = `
        <div class="small ghost">Sentence</div>
        <div class="big">${s.en}</div>
        <div class="qa small" style="margin-top:8px">${state.showJP? s.jp : ''}</div>`;
      stage.appendChild(card);
    }

    function renderQA(){
      const total = qa.length;
      const item = qa[state.i];
      stage.innerHTML='';
      stage.appendChild(navControls(total));
      const card = document.createElement('div');
      card.className='chip';
      card.innerHTML = `
        <div class="small ghost">Q&A</div>
        <div class="big" style="margin-bottom:6px">Q. ${item.q}</div>
        <div class="qa"><span class="small">A.</span> ${item.a}</div>
        <div class="qa small">${state.showJP? item.jp : ''}</div>`;
      stage.appendChild(card);
    }

    function renderQuiz(){
      const idx = state.quizIndex;
      const total = quiz.length;
      const q = quiz[idx];
      stage.innerHTML = '';

      // Header + progress
      const head = document.createElement('div');
      head.className='row';
      head.innerHTML = `
        <div class="flex">
          <button class="btn" id="restart">Restart</button>
          <span class="note">Wrong answers stay red. Choose the correct answer to continue.</span>
        </div>
        <div class="flex" style="min-width:220px;justify-content:flex-end">
          <div class="progress" style="width:200px"><div style="width:${((idx)/total)*100}%"></div></div>
          <span class="small">${idx} / ${total}</span>
        </div>`;
      head.querySelector('#restart').onclick = ()=>{ state.quizIndex = 0; renderQuiz(); };
      stage.appendChild(head);

      // Question card
      const box = document.createElement('div');
      box.className='chip';
      const title = document.createElement('div');
      title.className='big';
      title.textContent = q.q;
      box.appendChild(title);

      // Options with behavior: keep wrong red; only allow Next after correct
      const optsWrap = document.createElement('div');
      let solved = false;
      q.options.forEach((t,i)=>{
        const b = document.createElement('button');
        b.className='opt';
        b.textContent = `${String.fromCharCode(65+i)}. ${t}`;
        b.onclick = ()=>{
          if(solved) return; // ignore after solve
          if(i===q.answer){
            b.classList.add('right');
            solved = true;
            nextBtn.disabled = false;
            progressNow();
          } else {
            b.classList.add('wrong');
            b.disabled = true; // keep it red and disabled
          }
        };
        optsWrap.appendChild(b);
      });
      box.appendChild(optsWrap);

      // Footer controls
      const foot = document.createElement('div');
      foot.className='row';
      const left = document.createElement('div');
      left.className='flex';
      const right = document.createElement('div');
      right.className='flex';
      const nextBtn = document.createElement('button');
      nextBtn.className='btn';
      nextBtn.textContent = idx === total-1 ? 'Finish' : 'Next ‚ñ∂';
      nextBtn.disabled = true; // locked until correct
      nextBtn.onclick = ()=>{
        if(idx < total-1){ state.quizIndex++; renderQuiz(); }
        else { renderQuizSummary(); }
      };
      right.appendChild(nextBtn);
      foot.appendChild(left); foot.appendChild(right);

      stage.appendChild(box);
      stage.appendChild(foot);

      function progressNow(){
        // (Optional) mini effect; no external libs
        box.style.outline = '2px solid var(--right)';
        setTimeout(()=> box.style.outline = 'none', 300);
      }
    }

    function renderQuizSummary(){
      stage.innerHTML='';
      const done = document.createElement('div');
      done.className='chip';
      done.innerHTML = `
        <div class="big">Great job! üéâ</div>
        <div class="small">You finished all ${quiz.length} questions.</div>
        <div class="flex" style="margin-top:10px">
          <button class="btn" id="again">Restart Quiz</button>
          <button class="btn" id="back">Back to Vocab</button>
        </div>`;
      stage.appendChild(done);
      done.querySelector('#again').onclick = ()=>{ state.quizIndex=0; renderQuiz(); };
      done.querySelector('#back').onclick = ()=>{ state.mode='vocab-j2e'; state.i=0; saveHash(); render(); };
    }

    function render(){
      renderBar();
      if(state.mode==='vocab-j2e') return renderVocabJ2E();
      if(state.mode==='vocab-e2j') return renderVocabE2J();
      if(state.mode==='sentences') return renderSentences();
      if(state.mode==='qa') return renderQA();
      if(state.mode==='quiz') return renderQuiz();
    }

    // Init
    loadHash();
    render();
    window.addEventListener('hashchange', ()=>{ loadHash(); render(); });
  </script>
</body>
</html>
